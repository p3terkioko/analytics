<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Insights Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0f0a;
            color: #ffffff;
            overflow-x: auto;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            min-height: 100vh;
            gap: 20px;
            padding: 20px;
        }

        /* Sidebar */
        .sidebar {
            background: #1a2520;
            border-radius: 12px;
            padding: 20px;
            height: fit-content;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .logo::before {
            content: '🎵';
            font-size: 20px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            color: #8a9a8a;
            cursor: pointer;
            transition: color 0.2s;
        }

        .nav-item:hover, .nav-item.active {
            color: #4ade80;
        }

        .nav-item::before {
            width: 16px;
            height: 16px;
            content: '○';
            font-size: 12px;
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header-section {
            background: linear-gradient(135deg, #2a4a3a, #1a3a2a);
            border-radius: 16px;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .header-section::after {
            content: '';
            position: absolute;
            right: 20px;
            top: 20px;
            width: 100px;
            height: 100px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 L30 90 L70 90 Z" fill="%23ffffff20"/></svg>');
            opacity: 0.3;
        }

        .overview-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .stat-card {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #4ade80;
        }

        .stat-label {
            color: #8a9a8a;
            margin-top: 5px;
        }

        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .chart-container {
            background: #1a2520;
            border-radius: 12px;
            padding: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #8a9a8a;
        }

        .bar-chart {
            display: flex;
            align-items: end;
            gap: 8px;
            height: 150px;
            margin-bottom: 10px;
        }

        .bar {
            flex: 1;
            background: #4ade80;
            border-radius: 4px 4px 0 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .bar:hover {
            background: #22c55e;
            transform: scaleY(1.1);
        }

        .chart-labels {
            display: flex;
            gap: 8px;
            font-size: 12px;
            color: #6a7a6a;
        }

        .chart-labels span {
            flex: 1;
            text-align: center;
        }

        /* API Explorer */
        .api-section {
            background: #1a2520;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .api-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .api-endpoint {
            background: #0f1a0f;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #2a3a2a;
        }

        .endpoint-method {
            color: #4ade80;
            font-weight: 600;
            font-size: 12px;
        }

        .endpoint-path {
            color: #ffffff;
            margin: 5px 0;
            font-family: monospace;
        }

        .endpoint-desc {
            color: #8a9a8a;
            font-size: 14px;
        }

        .code-block {
            background: #0a1a0a;
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            color: #4ade80;
            border: 1px solid #2a3a2a;
        }

        .btn {
            background: #4ade80;
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-right: 10px;
            transition: background 0.2s;
        }

        .btn:hover {
            background: #22c55e;
        }

        .btn-secondary {
            background: transparent;
            color: #8a9a8a;
            border: 1px solid #2a3a2a;
        }

        /* Right Sidebar */
        .right-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .playlist-section, .contributors-section, .tracks-section {
            background: #1a2520;
            border-radius: 12px;
            padding: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .track-item, .contributor-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid #2a3a2a;
        }

        .track-item:last-child, .contributor-item:last-child {
            border-bottom: none;
        }

        .track-avatar, .contributor-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4ade80, #22c55e);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #000;
        }

        .track-info, .contributor-info {
            flex: 1;
        }

        .track-name, .contributor-name {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .track-artist, .contributor-role {
            color: #8a9a8a;
            font-size: 14px;
        }

        .track-time {
            color: #6a7a6a;
            font-size: 12px;
        }

        .search-box {
            background: #0f1a0f;
            border: 1px solid #2a3a2a;
            border-radius: 8px;
            padding: 10px 15px;
            color: #ffffff;
            width: 100%;
            margin-bottom: 15px;
        }

        .search-box::placeholder {
            color: #6a7a6a;
        }

        .top-contributors {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .top-contributor {
            text-align: center;
            flex: 1;
        }

        .top-contributor-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4ade80, #22c55e);
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #000;
        }

        .top-contributor-name {
            font-size: 12px;
            font-weight: 600;
        }

        .top-contributor-tracks {
            font-size: 10px;
            color: #8a9a8a;
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 200px 1fr 250px;
            }
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="logo">Music Insights</div>
            <nav>
                <div class="nav-item active">Home</div>
                <div class="nav-item">Tracks</div>
                <div class="nav-item">Contributors</div>
                <div class="nav-item">API Explorer</div>
                <div class="nav-item">Settings</div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header Section -->
            <div class="header-section">
                <h1 class="overview-title">Overview</h1>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Top Artists</div>
                        <div class="stat-number">5</div>
                        <div class="stat-label">artists</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Top Genres</div>
                        <div class="stat-number">3</div>
                        <div class="stat-label">genres</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Top Contributors</div>
                        <div class="stat-number">3</div>
                        <div class="stat-label">contributors</div>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="chart-container">
                    <div class="chart-title">Top 10 Artists</div>
                    <div class="bar-chart" id="artistChart">
                        <div class="bar" style="height: 80%;"></div>
                        <div class="bar" style="height: 65%;"></div>
                        <div class="bar" style="height: 90%;"></div>
                        <div class="bar" style="height: 45%;"></div>
                        <div class="bar" style="height: 70%;"></div>
                        <div class="bar" style="height: 55%;"></div>
                        <div class="bar" style="height: 40%;"></div>
                        <div class="bar" style="height: 35%;"></div>
                        <div class="bar" style="height: 30%;"></div>
                        <div class="bar" style="height: 25%;"></div>
                    </div>
                    <div class="chart-labels">
                        <span>Artist1</span>
                        <span>Artist2</span>
                        <span>Artist3</span>
                        <span>Artist4</span>
                        <span>Artist5</span>
                        <span>Artist6</span>
                        <span>Artist7</span>
                        <span>Artist8</span>
                        <span>Artist9</span>
                        <span>Artist10</span>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Genre Distribution</div>
                    <div class="bar-chart" id="genreChart">
                        <div class="bar" style="height: 85%;"></div>
                        <div class="bar" style="height: 60%;"></div>
                        <div class="bar" style="height: 40%;"></div>
                    </div>
                    <div class="chart-labels">
                        <span>Genre 1</span>
                        <span>Genre 2</span>
                        <span>Genre 3</span>
                    </div>
                </div>
            </div>

            <!-- API Explorer -->
            <div class="api-section">
                <div class="api-title">API Explorer</div>
                
                <div class="api-endpoint">
                    <div class="endpoint-method">GET</div>
                    <div class="endpoint-path">/playlists/analyze</div>
                    <div class="endpoint-desc">Analyzes the playlist to identify top artists, genres, and contributors.</div>
                    <div class="code-block">
{
  "top_artists": ["Artist1", "Artist2", "Artist3"],
  "top_genres": ["Pop", "Rock", "Electronic"],
  "contributors": ["User1", "User2", "User3"]
}
                    </div>
                    <button class="btn">Copy JSON</button>
                    <button class="btn btn-secondary">Download</button>
                </div>

                <div class="api-endpoint">
                    <div class="endpoint-method">GET</div>
                    <div class="endpoint-path">/playlists/tracks</div>
                    <div class="endpoint-desc">Retrieve the listing of tracks in the playlist.</div>
                    <div class="code-block">
{
  "tracks": [
    {"title": "Track 1", "artist": "Artist Name", "album": "Album Name"},
    {"title": "Track 2", "artist": "Artist Name", "album": "Album Name"}
  ]
}
                    </div>
                    <button class="btn">Copy JSON</button>
                    <button class="btn btn-secondary">Download</button>
                </div>

                <div class="api-endpoint">
                    <div class="endpoint-method">GET</div>
                    <div class="endpoint-path">/playlists/contributors</div>
                    <div class="endpoint-desc">Lists all contributors to the playlist.</div>
                    <button class="btn">Try</button>
                </div>
            </div>
        </div>

        <!-- Right Sidebar -->
        <div class="right-sidebar">
            <!-- Playlist Tracks -->
            <div class="playlist-section">
                <div class="section-title">Playlist Tracks</div>
                <input type="text" class="search-box" placeholder="Search">
                
                <div class="track-item">
                    <div class="track-avatar">MC</div>
                    <div class="track-info">
                        <div class="track-name">Midnight Cinema</div>
                        <div class="track-artist">Dark Hearts</div>
                    </div>
                    <div class="track-time">Electronic</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">CL</div>
                    <div class="track-info">
                        <div class="track-name">City Lights</div>
                        <div class="track-artist">Urban Beats</div>
                    </div>
                    <div class="track-time">Pop</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">OR</div>
                    <div class="track-info">
                        <div class="track-name">Ocean Breeze</div>
                        <div class="track-artist">Sea Harmony</div>
                    </div>
                    <div class="track-time">Indie Folk</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">DS</div>
                    <div class="track-info">
                        <div class="track-name">Desert Sunrise</div>
                        <div class="track-artist">Desert Dream</div>
                    </div>
                    <div class="track-time">Rock</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">MN</div>
                    <div class="track-info">
                        <div class="track-name">Mountain high</div>
                        <div class="track-artist">Nature Bright</div>
                    </div>
                    <div class="track-time">Folk</div>
                </div>
            </div>

            <!-- Contributors -->
            <div class="contributors-section">
                <div class="section-title">Who Added What</div>
                
                <div class="top-contributors">
                    <div class="top-contributor">
                        <div class="top-contributor-avatar">EC</div>
                        <div class="top-contributor-name">Ethan Carter</div>
                        <div class="top-contributor-tracks">15 tracks</div>
                    </div>
                    <div class="top-contributor">
                        <div class="top-contributor-avatar">SC</div>
                        <div class="top-contributor-name">Sophie Clark</div>
                        <div class="top-contributor-tracks">12 tracks</div>
                    </div>
                    <div class="top-contributor">
                        <div class="top-contributor-avatar">LB</div>
                        <div class="top-contributor-name">Liam Bennett</div>
                        <div class="top-contributor-tracks">8 tracks</div>
                    </div>
                </div>

                <div class="contributor-item">
                    <div class="contributor-avatar">AM</div>
                    <div class="contributor-info">
                        <div class="contributor-name">Ava Harper</div>
                        <div class="contributor-role">7 tracks added</div>
                    </div>
                </div>

                <div class="contributor-item">
                    <div class="contributor-avatar">NF</div>
                    <div class="contributor-info">
                        <div class="contributor-name">Noah Foster</div>
                        <div class="contributor-role">5 tracks added</div>
                    </div>
                </div>

                <div class="contributor-item">
                    <div class="contributor-avatar">OR</div>
                    <div class="contributor-info">
                        <div class="contributor-name">Olivia Reed</div>
                        <div class="contributor-role">4 tracks added</div>
                    </div>
                </div>

                <div class="contributor-item">
                    <div class="contributor-avatar">JH</div>
                    <div class="contributor-info">
                        <div class="contributor-name">Jackson Hayes</div>
                        <div class="contributor-role">3 tracks added</div>
                    </div>
                </div>

                <div class="contributor-item">
                    <div class="contributor-avatar">IM</div>
                    <div class="contributor-info">
                        <div class="contributor-name">Isabella Morgan</div>
                        <div class="contributor-role">2 tracks added</div>
                    </div>
                </div>
            </div>

            <!-- Tracks Section -->
            <div class="tracks-section">
                <div class="section-title">Tracks</div>
                <input type="text" class="search-box" placeholder="Find">
                
                <div class="track-item">
                    <div class="track-avatar">MC</div>
                    <div class="track-info">
                        <div class="track-name">Midnight Cinema</div>
                        <div class="track-artist">Armin Dreamer</div>
                    </div>
                    <div class="track-time">3:45</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">NR</div>
                    <div class="track-info">
                        <div class="track-name">Neon Nights</div>
                        <div class="track-artist">Digital Noir</div>
                    </div>
                    <div class="track-time">4:12</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">GE</def>
                    <div class="track-info">
                        <div class="track-name">Golden Echoes</div>
                        <div class="track-artist">Space Cadet</div>
                    </div>
                    <div class="track-time">3:58</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">CR</div>
                    <div class="track-info">
                        <div class="track-name">Cosmic Rhythm</div>
                        <div class="track-artist">Comet Beat</div>
                    </div>
                    <div class="track-time">4:23</div>
                </div>

                <div class="track-item">
                    <div class="track-avatar">VM</div>
                    <div class="track-info">
                        <div class="track-name">Velvet Mirage</div>
                        <div class="track-artist">Red Garden</div>
                    </div>
                    <div class="track-time">3:30</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize dashboard functionality
        document.addEventListener('DOMContentLoaded', function() {
            function getInitials(name) {
                if (!name || typeof name !== 'string') {
                    return '';
                }
                const words = name.trim().split(/\s+/);
                if (words.length > 1) {
                    return (words[0][0] + words[1][0]).toUpperCase();
                } else if (name.length >= 2) {
                    return name.substring(0, 2).toUpperCase();
                } else {
                    return name.toUpperCase();
                }
            }

            const backendData = {
              "topArtists": [
                { "name": "Brendan Ross", "count": 8 },
                { "name": "Eminem", "count": 8 },
                { "name": "Mutoriah", "count": 5 },
                { "name": "Bien", "count": 4 },
                { "name": "Nyashinski", "count": 4 },
                { "name": "J. Cole", "count": 4 },
                { "name": "Coldplay", "count": 3 },
                { "name": "Watendawili", "count": 3 },
                { "name": "Hozier", "count": 3 },
                { "name": "Kanye West", "count": 3 }
              ],
              "topGenres": [
                { "name": "afro soul", "count": 51 },
                { "name": "amapiano", "count": 46 },
                { "name": "gqom", "count": 42 },
                { "name": "afropop", "count": 41 },
                { "name": "afropiano", "count": 40 },
                { "name": "afro r&b", "count": 37 },
                { "name": "afrobeats", "count": 31 },
                { "name": "gengetone", "count": 30 },
                { "name": "private school piano", "count": 29 },
                { "name": "rumba congolaise", "count": 27 }
              ],
              "topUsers": [
                { "id": "xua99owgtnso375kz2zz41rtf", "displayName": "Dr. C", "count": 70 },
                { "id": "31gqlwjf2ejtzfcv7yhjgpebhuxa", "displayName": "Pepp🍂", "count": 24 },
                { "id": "31t76imks5ojgagmhuclld6bvbuq", "displayName": "0xFidel", "count": 21 },
                { "id": "a3a3hg4jr1ezhnww7u2pck6vi", "displayName": "tanuiii", "count": 12 },
                { "id": "31h7e6lwcumgv67635rand65lj6e", "displayName": "Ryan", "count": 11 },
                { "id": "cl4u400dvbwcmn6vkind9twor", "displayName": "Kush", "count": 10 },
                { "id": "xpe4w9i4tfeufakd7jfu1js6n", "displayName": "Sidoniasimanto", "count": 7 },
                { "id": "312r66ff2zkgga3jxwcf7oeofbaq", "displayName": "Maddy", "count": 6 },
                { "id": "nj6cjteprs0j0xs81x9ac7zek", "displayName": "Peterwambua", "count": 6 },
                { "id": "31lshdib3ipz2tbwbloklk5j4pn4", "displayName": "Kristian", "count": 6 }
              ]
            };

            function renderOverviewStats() {
                const statCards = document.querySelectorAll('.stats-grid .stat-card');
                statCards.forEach(card => {
                    const labels = card.querySelectorAll('.stat-label');
                    const numberEl = card.querySelector('.stat-number');
                    if (!labels.length || !numberEl) return;

                    const mainLabelText = labels[0].textContent.trim();
                    let count = 0;
                    let unitLabel = '';

                    if (mainLabelText === 'Top Artists') {
                        count = backendData.topArtists.length;
                        unitLabel = 'artists';
                    } else if (mainLabelText === 'Top Genres') {
                        count = backendData.topGenres.length;
                        unitLabel = 'genres';
                    } else if (mainLabelText === 'Top Contributors') {
                        count = backendData.topUsers.length;
                        unitLabel = 'contributors';
                    }

                    numberEl.textContent = count;
                    if (labels.length > 1) {
                        labels[1].textContent = unitLabel;
                    }
                });
            }
            renderOverviewStats();

            function renderArtistChart() {
                const artistChartDiv = document.getElementById('artistChart');
                const artistLabelsDiv = artistChartDiv.nextElementSibling; // Assumes .chart-labels is the immediate next sibling

                // Clear existing content
                artistChartDiv.innerHTML = '';
                if (artistLabelsDiv) {
                    artistLabelsDiv.innerHTML = '';
                }

                if (!backendData.topArtists || backendData.topArtists.length === 0) {
                    artistChartDiv.textContent = 'No artist data available';
                    return;
                }

                const topArtistsData = backendData.topArtists;
                let maxCount = 0;
                topArtistsData.forEach(artist => {
                    if (artist.count > maxCount) {
                        maxCount = artist.count;
                    }
                });

                topArtistsData.forEach(artist => {
                    // Create bar
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    const barHeightPercentage = maxCount > 0 ? (artist.count / maxCount) * 100 : 0;
                    bar.style.height = barHeightPercentage + '%';
                    artistChartDiv.appendChild(bar);

                    // Create label
                    if (artistLabelsDiv) {
                        const label = document.createElement('span');
                        label.textContent = artist.name;
                        artistLabelsDiv.appendChild(label);
                    }
                });

                // Re-apply hover effects for dynamically added bars if necessary
                // This might be needed if the original hover effect setup doesn't cover dynamic elements.
                // However, the current CSS hover effect should work for new .bar elements.
                // Add bar animation like in the original static version
                const bars = artistChartDiv.querySelectorAll('.bar');
                 setTimeout(() => {
                    bars.forEach((bar, index) => {
                        bar.style.transform = 'scaleY(0)'; // Initial state for animation
                        setTimeout(() => {
                            bar.style.transition = 'transform 0.6s ease';
                            bar.style.transform = 'scaleY(1)';
                        }, index * 100); // Stagger animation
                    });
                }, 100); // Small delay to ensure elements are rendered
            }
            renderArtistChart();

            function renderGenreChart() {
                const genreChartDiv = document.getElementById('genreChart');
                const genreLabelsDiv = genreChartDiv.nextElementSibling; // Assumes .chart-labels is the immediate next sibling

                // Clear existing content
                genreChartDiv.innerHTML = '';
                if (genreLabelsDiv) {
                    genreLabelsDiv.innerHTML = '';
                }

                if (!backendData.topGenres || backendData.topGenres.length === 0) {
                    genreChartDiv.textContent = 'No genre data available';
                    return;
                }

                const topGenresData = backendData.topGenres;
                let maxCount = 0;
                topGenresData.forEach(genre => {
                    if (genre.count > maxCount) {
                        maxCount = genre.count;
                    }
                });

                topGenresData.forEach(genre => {
                    // Create bar
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    const barHeightPercentage = maxCount > 0 ? (genre.count / maxCount) * 100 : 0;
                    bar.style.height = barHeightPercentage + '%';
                    genreChartDiv.appendChild(bar);

                    // Create label
                    if (genreLabelsDiv) {
                        const label = document.createElement('span');
                        label.textContent = genre.name;
                        genreLabelsDiv.appendChild(label);
                    }
                });

                // Add bar animation
                const bars = genreChartDiv.querySelectorAll('.bar');
                setTimeout(() => {
                    bars.forEach((bar, index) => {
                        bar.style.transform = 'scaleY(0)'; // Initial state for animation
                        setTimeout(() => {
                            bar.style.transition = 'transform 0.6s ease';
                            bar.style.transform = 'scaleY(1)';
                        }, index * 100); // Stagger animation
                    });
                }, 100); // Small delay
            }
            renderGenreChart();

            function renderApiExplorer() {
                const apiEndpoints = document.querySelectorAll('.api-section .api-endpoint');

                apiEndpoints.forEach(endpoint => {
                    const pathElement = endpoint.querySelector('.endpoint-path');
                    const codeBlockElement = endpoint.querySelector('.code-block');

                    if (pathElement && codeBlockElement) {
                        const pathText = pathElement.textContent.trim();

                        if (pathText === '/playlists/analyze') {
                            const simplifiedData = {
                                topArtists: backendData.topArtists.slice(0, 3).map(artist => artist.name),
                                topGenres: backendData.topGenres.slice(0, 3).map(genre => genre.name),
                                topUsers: backendData.topUsers.slice(0, 3).map(user => user.displayName)
                            };
                            codeBlockElement.textContent = JSON.stringify(simplifiedData, null, 2);
                        } else if (pathText === '/playlists/tracks') {
                            const sampleTracks = {
                                "tracks": [
                                    { "title": "Sample Track 1", "artist": "Sample Artist", "album": "Sample Album" },
                                    { "title": "Sample Track 2", "artist": "Another Artist", "album": "Another Album" }
                                ]
                            };
                            codeBlockElement.textContent = JSON.stringify(sampleTracks, null, 2);
                        }
                    }
                });
            }
            renderApiExplorer();

            function renderPlaylistTracks() {
                const playlistSection = document.querySelector('.playlist-section');
                if (!playlistSection) return;

                // Remove existing track items
                const existingTrackItems = playlistSection.querySelectorAll('.track-item');
                existingTrackItems.forEach(item => item.remove());

                if (!backendData.topArtists || backendData.topArtists.length === 0) {
                    const message = document.createElement('p');
                    message.textContent = 'No tracks to display (using top artists as sample data).';
                    message.style.textAlign = 'center';
                    message.style.padding = '20px';
                    // Make sure not to append if a search box or title is the only thing left
                    const sectionTitle = playlistSection.querySelector('.section-title');
                    const searchBox = playlistSection.querySelector('.search-box');
                    let lastElement = playlistSection.lastElementChild;
                    if (lastElement === searchBox || lastElement === sectionTitle) {
                        playlistSection.appendChild(message);
                    } else if (searchBox && searchBox.nextSibling) {
                         searchBox.parentNode.insertBefore(message, searchBox.nextSibling);
                    } else {
                         playlistSection.appendChild(message);
                    }
                    return;
                }

                const artistsToDisplay = backendData.topArtists.slice(0, 5);

                artistsToDisplay.forEach(artist => {
                    const trackItem = document.createElement('div');
                    trackItem.className = 'track-item';

                    const avatarDiv = document.createElement('div');
                    avatarDiv.className = 'track-avatar';
                    avatarDiv.textContent = getInitials(artist.name);

                    const trackInfoDiv = document.createElement('div');
                    trackInfoDiv.className = 'track-info';

                    const trackNameDiv = document.createElement('div');
                    trackNameDiv.className = 'track-name';
                    trackNameDiv.textContent = artist.name;

                    const trackArtistDiv = document.createElement('div');
                    trackArtistDiv.className = 'track-artist'; // Re-using class, content indicates plays
                    trackArtistDiv.textContent = "Plays: " + artist.count;

                    trackInfoDiv.appendChild(trackNameDiv);
                    trackInfoDiv.appendChild(trackArtistDiv);

                    const trackTimeDiv = document.createElement('div');
                    trackTimeDiv.className = 'track-time'; // Re-using class, content indicates "Top Artist"
                    trackTimeDiv.textContent = "Top Artist";

                    trackItem.appendChild(avatarDiv);
                    trackItem.appendChild(trackInfoDiv);
                    trackItem.appendChild(trackTimeDiv);

                    playlistSection.appendChild(trackItem);
                });
            }
            renderPlaylistTracks();

            function renderContributors() {
                const contributorsSection = document.querySelector('.contributors-section');
                if (!contributorsSection) return;

                const topContributorsDiv = contributorsSection.querySelector('.top-contributors');

                // Clear existing dynamic content
                if (topContributorsDiv) {
                    const existingTopContributors = topContributorsDiv.querySelectorAll('.top-contributor');
                    existingTopContributors.forEach(item => item.remove());
                }
                const existingContributorItems = contributorsSection.querySelectorAll('.contributor-item');
                existingContributorItems.forEach(item => item.remove());

                if (!backendData.topUsers || backendData.topUsers.length === 0) {
                    const message = document.createElement('p');
                    message.textContent = 'No contributor data available.';
                    message.style.textAlign = 'center';
                    message.style.padding = '20px';
                    // Append after .top-contributors div if it exists, otherwise just append to section
                    if (topContributorsDiv) {
                         topContributorsDiv.parentNode.insertBefore(message, topContributorsDiv.nextSibling);
                    } else {
                        contributorsSection.appendChild(message);
                    }
                    return;
                }

                // Render Top Contributors (Top 3)
                if (topContributorsDiv) {
                    const topThreeUsers = backendData.topUsers.slice(0, 3);
                    topThreeUsers.forEach(user => {
                        const topContributorDiv = document.createElement('div');
                        topContributorDiv.className = 'top-contributor';

                        const avatarDiv = document.createElement('div');
                        avatarDiv.className = 'top-contributor-avatar';
                        avatarDiv.textContent = getInitials(user.displayName);

                        const nameDiv = document.createElement('div');
                        nameDiv.className = 'top-contributor-name';
                        nameDiv.textContent = user.displayName;

                        const tracksDiv = document.createElement('div');
                        tracksDiv.className = 'top-contributor-tracks';
                        tracksDiv.textContent = user.count + " tracks";

                        topContributorDiv.appendChild(avatarDiv);
                        topContributorDiv.appendChild(nameDiv);
                        topContributorDiv.appendChild(tracksDiv);
                        topContributorsDiv.appendChild(topContributorDiv);
                    });
                }

                // Render All Contributors (List)
                backendData.topUsers.forEach(user => {
                    const contributorItemDiv = document.createElement('div');
                    contributorItemDiv.className = 'contributor-item';

                    const avatarDiv = document.createElement('div');
                    avatarDiv.className = 'contributor-avatar';
                    avatarDiv.textContent = getInitials(user.displayName);

                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'contributor-info';

                    const nameDiv = document.createElement('div');
                    nameDiv.className = 'contributor-name';
                    nameDiv.textContent = user.displayName;

                    const roleDiv = document.createElement('div');
                    roleDiv.className = 'contributor-role';
                    roleDiv.textContent = user.count + " tracks added";

                    infoDiv.appendChild(nameDiv);
                    infoDiv.appendChild(roleDiv);

                    contributorItemDiv.appendChild(avatarDiv);
                    contributorItemDiv.appendChild(infoDiv);

                    contributorsSection.appendChild(contributorItemDiv); // Appends to the end of the section
                });
            }
            renderContributors();

            function renderTracksSection() {
                const tracksSection = document.querySelector('.tracks-section');
                if (!tracksSection) return;

                // Remove existing track items
                const existingTrackItems = tracksSection.querySelectorAll('.track-item');
                existingTrackItems.forEach(item => item.remove());

                if (!backendData.topGenres || backendData.topGenres.length === 0) {
                    const message = document.createElement('p');
                    message.textContent = 'No tracks to display (using top genres as sample data).';
                    message.style.textAlign = 'center';
                    message.style.padding = '20px';
                     // Make sure not to append if a search box or title is the only thing left
                    const sectionTitle = tracksSection.querySelector('.section-title');
                    const searchBox = tracksSection.querySelector('.search-box');
                    let lastElement = tracksSection.lastElementChild;
                    if (lastElement === searchBox || lastElement === sectionTitle) {
                        tracksSection.appendChild(message);
                    } else if (searchBox && searchBox.nextSibling) {
                         searchBox.parentNode.insertBefore(message, searchBox.nextSibling);
                    } else {
                         tracksSection.appendChild(message);
                    }
                    return;
                }

                const genresToDisplay = backendData.topGenres.slice(0, 5);

                genresToDisplay.forEach(genre => {
                    const trackItem = document.createElement('div');
                    trackItem.className = 'track-item';

                    const avatarDiv = document.createElement('div');
                    avatarDiv.className = 'track-avatar';
                    avatarDiv.textContent = getInitials(genre.name);

                    const trackInfoDiv = document.createElement('div');
                    trackInfoDiv.className = 'track-info';

                    const trackNameDiv = document.createElement('div');
                    trackNameDiv.className = 'track-name';
                    trackNameDiv.textContent = genre.name; // Using genre name as track name

                    const trackArtistDiv = document.createElement('div');
                    trackArtistDiv.className = 'track-artist'; // Re-using class, content indicates count
                    trackArtistDiv.textContent = "Count: " + genre.count;

                    trackInfoDiv.appendChild(trackNameDiv);
                    trackInfoDiv.appendChild(trackArtistDiv);

                    const trackTimeDiv = document.createElement('div');
                    trackTimeDiv.className = 'track-time'; // Re-using class, content indicates "Genre"
                    trackTimeDiv.textContent = "Genre";

                    trackItem.appendChild(avatarDiv);
                    trackItem.appendChild(trackInfoDiv);
                    trackItem.appendChild(trackTimeDiv);

                    tracksSection.appendChild(trackItem);
                });
            }
            renderTracksSection();

            // Navigation functionality
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Search functionality
            const searchBoxes = document.querySelectorAll('.search-box');
            searchBoxes.forEach(box => {
                box.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const container = this.closest('.playlist-section, .tracks-section');
                    const items = container.querySelectorAll('.track-item');
                    
                    items.forEach(item => {
                        const trackName = item.querySelector('.track-name').textContent.toLowerCase();
                        const artistName = item.querySelector('.track-artist').textContent.toLowerCase();
                        
                        if (trackName.includes(searchTerm) || artistName.includes(searchTerm)) {
                            item.style.display = 'flex';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            });

            // Bar chart hover effects
            const bars = document.querySelectorAll('.bar');
            bars.forEach(bar => {
                bar.addEventListener('mouseenter', function() {
                    this.style.transform = 'scaleY(1.1)';
                    this.style.background = '#22c55e';
                });
                
                bar.addEventListener('mouseleave', function() {
                    this.style.transform = 'scaleY(1)';
                    this.style.background = '#4ade80';
                });
            });

            // Copy JSON functionality
            const copyButtons = document.querySelectorAll('.btn:not(.btn-secondary)');
            copyButtons.forEach(button => {
                if (button.textContent.includes('Copy')) {
                    button.addEventListener('click', function() {
                        const codeBlock = this.parentElement.querySelector('.code-block');
                        if (codeBlock) {
                            navigator.clipboard.writeText(codeBlock.textContent).then(() => {
                                const originalText = this.textContent;
                                this.textContent = 'Copied!';
                                setTimeout(() => {
                                    this.textContent = originalText;
                                }, 2000);
                            });
                        }
                    });
                }
            });

            // Animate bars on load
            setTimeout(() => {
                bars.forEach((bar, index) => {
                    bar.style.transform = 'scaleY(0)';
                    setTimeout(() => {
                        bar.style.transition = 'transform 0.6s ease';
                        bar.style.transform = 'scaleY(1)';
                    }, index * 100);
                });
            }, 500);

            // Track item interactions
            const trackItems = document.querySelectorAll('.track-item');
            trackItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Remove active class from all items
                    trackItems.forEach(track => track.classList.remove('active'));
                    // Add active class to clicked item
                    this.classList.add('active');
                });
            });

            // Simulate real-time data updates
            setInterval(() => {
                const statNumbers = document.querySelectorAll('.stat-number');
                statNumbers.forEach(stat => {
                    const currentValue = parseInt(stat.textContent);
                    // Randomly increase or decrease by 1
                    const change = Math.random() > 0.5 ? 1 : -1;
                    const newValue = Math.max(0, currentValue + change);
                    stat.textContent = newValue;
                });
            }, 10000); // Update every 10 seconds
        });
    </script>
</body>
</html>